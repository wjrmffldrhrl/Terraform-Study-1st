# Why Terraform	
μ΄ μ¥μ—μ„ λ‹¤λ£° μ£Όμ 

- λ°λΈμµμ¤μ™€ λ°°ν¬ μλ™ν™”
- μ½”λ“ν• μΈν”„λΌ
- ν…λΌνΌ μ‘λ™ λ°©μ‹
- ν…λΌνΌκ³Ό λ‹¤λ¥Έ μ½”λ“ν• μΈν”„λΌ λ„κµ¬ λΉ„κµ

## λ°λΈμµμ¤μ™€ λ°°ν¬ μλ™ν™”
λ°λΈμµμ¤(DevOps)λ” ν€μ΄λ‚ μ§μ±… λλ” νΉμ • κΈ°μ μ΄ μ•„λ‹λ‹¤. μ†ν”„νΈμ›¨μ–΄λ¥Ό ν¨μ¨μ μΌλ΅ μ „λ‹¬ν•κΈ° μ„ν• ν”„λ΅μ„Έμ¤, μ•„μ΄λ””μ–΄, ν…ν¬λ‹‰μ΄λ‹¤. 

- μ§€μ†μ μΌλ΅ μ½”λ“λ¥Ό ν†µν•©ν•κ³  ν•­μƒ λ°°ν¬ κ°€λ¥ν• μƒνƒλ΅ μ μ§€
- νƒ„λ ¥μ μ΄κ³  μκ°€ μΉμ μ μΈ μ‹μ¤ν… κµ¬μ¶•
- λ¨λ‹ν„°λ§ λ° μ•λ¦Ό κΈ°λ¥μ„ μ‚¬μ©ν•μ—¬ μλ™μΌλ΅ ν•΄κ²°ν•  μ μ—†λ” λ¬Έμ μ— λ€λΉ„

ν΄λΌμ°λ“ μ„λΉ„μ¤κ°€ λ€μ¤‘ν™” λλ©° μ§μ ‘ λ°μ΄ν„°μ„Όν„°λ¥Ό μ΄μν•λ” λ€μ‹  μ†ν”„νΈμ›¨μ–΄ μ‘μ—…μ„ ν†µν•΄ μΈν”„λΌλ¥Ό κµ¬μ„±ν•  μ μκ² λμ—λ‹¤. μ½”λ“λ¥Ό ν†µν•΄ μΈν”„λΌλ¥Ό κ΄€λ¦¬ν•λ” κ²ƒμ„ β€***μ½”λ“ν• μΈν”„λΌ***β€™λΌκ³  ν•λ‹¤. 

## μ½”λ“ν• μΈν”„λΌ

μ½”λ“ν• μΈν”„λΌ(Infrastructure as Code, IaC)λ€ μ½”λ“λ¥Ό μ‘μ„± λ° μ‹¤ν–‰ν•μ—¬ μΈν”„λΌλ¥Ό μƒμ„±, λ°°ν¬, μμ •, μ •λ¦¬ν•λ” κ²ƒμ„ λ§ν•λ‹¤ β†’ ν•λ“μ›¨μ–΄λ¥Ό ν¬ν•¨ν• μ΄μμ λ¨λ“  μΈ΅λ©΄μ„ μ†ν”„νΈμ›¨μ–΄μ μΌλ΅ μ‚¬κ³ 

### μ½”λ“ν• μΈν”„λΌ λ„κµ¬μ λ²”μ£Ό

- μ• λ“νΉ μ¤ν¬λ¦½νΈ
    - λ°°μ‹, λ£¨λΉ„, νμ΄μ¬ λ“± μ„ νΈν•λ” μ–Έμ–΄λ¥Ό μ‚¬μ©ν•μ—¬ μ‘μ„±λ μ¤ν¬λ¦½νΈλ¥Ό μ„λ²„μ—μ„ μλ™μΌλ΅ μ‹¤ν–‰
    - μ: *setup-webserver.sh*
    
    ```bash
    # Update the apt-get cache
    sudo apt-get update
    
    # Install PHP and Apache
    sudo apt-get install -y php apache2
    
    # Copy the code from the repository
    sudo git clone https://github.com/brikis98/php-app.git /var/www/html/app
    
    # Start Apache
    sudo service apache2 start
    ```
    
    - μ¥μ  : κ°€μ¥ κ°„λ‹¨ν•¨. μ†κ·λ¨ μΌνμ„± μ‘μ—…μ— μ ν•©
    - λ‹¨μ  :
        - μ‚¬μ©μκ°€ μλ™μΌλ΅ λ§μ¶¤ μ½”λ“λ¥Ό μ‘μ„±ν•΄μ•Ό ν•λ‹¤
        - λ²”μ© ν”„λ΅κ·Έλλ° μ–Έμ–΄λ” μ‚¬μ©μλ§λ‹¤ κ³ μ ν• μ¤νƒ€μΌμ΄ μμ
- κµ¬μ„± κ΄€λ¦¬ λ„κµ¬: μ…°ν”„, νΌν•, μ•¤μ„λΈ”, μ†”νΈμ¤νƒ
    - μ: μ•¤μ„λΈ” web-server.yml
    
    ```yaml
    - name: Update the apt-get cache
      apt:
        update_cache: yes
    
    - name: Install PHP
      apt:
        name: php
    
    - name: Install Apache
      apt:
        name: apache2
    
    - name: Copy the code from the repository
      git: repo=https://github.com/brikis98/php-app.git dest=/var/www/html/app
    
    - name: Start Apache
      service: name=apache2 state=started enabled=yes
    ```
    - μ½”λ”© κ·μΉ™
        - μΌκ΄€λκ³  μμΈ΅ κ°€λ¥ν• κµ¬μ΅°κ°€ μ κ³µλλ©° μ½”λ”© κ·μΉ™μ΄ ν¬ν•¨λμ–΄ μμ–΄ μ½”λ“λ¥Ό μ‰½κ² νƒμƒ‰ν•  μ μκ² ν•΄μ¤€λ‹¤
    - λ©±λ“±μ„±
        - μ‹¤ν–‰ νμμ— κ΄€κ³„μ—†μ΄ μ¬λ°”λ¥΄κ² λ™μ‘ν•λ” μ„±μ§
        - μλ¥Ό λ“¤μ–΄ μ•¤μ„λΈ” λ΅¤μ€ μ„¤μ • νμΌ(μ: web-server.yml)μ„ μ‚¬μ©ν•μ—¬ μ•„νμΉκ°€ μ„¤μΉλμ§€ μ•μ•μ„ κ²½μ°μ—λ§ μ„¤μΉν•κ³  μ•„νμΉ μ›Ή μ„λ²„κ°€ λ™μ‘ν•μ§€ μ•λ” κ²½μ°μ—λ§ λ™μ‘ν•λ„λ΅ ν•¨
    - λ¶„μ‚°ν• κµ¬μ΅°
        - μ• λ“νΉ μ¤ν¬λ¦½νΈλ” λ‹¨μΌ λ΅μ»¬ λ¨Έμ‹ μ—μ„λ§ μ‹¤ν–‰λλ„λ΅ μ„¤κ³„λμ–΄ μλ” λ°λ©΄ κµ¬μ„± κ΄€λ¦¬ λ„κµ¬λ” μ›κ²© μ„λ²„λ¥Ό κ΄€λ¦¬ν•κΈ° μ„ν•΄ μ„¤κ³„λ¨
        
        ![deploy_ansible](terraform_1_1.png)
        
        - λ§¤κ°λ³€μλ¥Ό μ„¤μ •ν•μ—¬ λ΅¤λ§ λ°°ν¬λ¥Ό μν–‰ν•κ±°λ‚ λ³‘λ ¬ μν–‰ μΉ΄μ΄νΈλ¥Ό μ§€μ •ν•  μλ„ μλ‹¤
- μ„λ²„ ν…ν”λ¦Ώ λ„κµ¬: λ„μ»¤, ν¨μ»¤, λ² μ΄κ·Έλ°νΈ(Vagrant)
    - κ°κ°μ μ„λ²„μ— λ™μΌν• μ½”λ“λ¥Ό μ‹¤ν–‰ν•μ—¬ κµ¬μ„±ν•λ” κΈ°μ΅΄ λ°©μ‹κ³Ό λ‹¤λ¥΄κ²
    - OS, μ†ν”„νΈμ›¨μ–΄, νμΌ λ“± ν•„μ”ν• λ¨λ“  λ‚΄μ©μ„ ν¬ν•¨ν•κ³  μλ” μ¤λƒ…μƒ· μ΄λ―Έμ§€λ¥Ό μƒμ„±ν•κ³  λ¨λ“  μ„λ²„μ— μ΄λ―Έμ§€λ¥Ό μ„¤μΉν•λ‹¤
    
    ![Untitled](terraform_1_2.png)
    
    - μ„λ²„ ν…ν”λ¦Ώ λ„κµ¬λ” κ°κ°μ λ©μ μ΄ μ•½κ°„μ”© λ‹¤λ¥΄λ‹¤
        - ν¨μ»¤ : AMIμ²λΌ ν”„λ΅λ•μ… μ„λ²„μ—μ„ μ§μ ‘ μ‹¤ν–‰ν•λ” μ΄λ―Έμ§€λ¥Ό μƒμ„±ν•λ” λ° μ‚¬μ©
        - λ² μ΄κ·Έλ°νΈ: macOS λ‚ windows λ©ν†±κ³Ό κ°™μ€ κ°λ° μ»΄ν“¨ν„°μ—μ„ μ‹¤ν–‰λλ” μ΄λ―Έμ§€λ¥Ό λ§λ“λ”λ° μ‚¬μ©
        - λ„μ»¤ : κ°λ³„ μ‘μ© ν”„λ΅κ·Έλ¨μ μ΄λ―Έμ§€λ¥Ό λ§λ“λ”λ° μ‚¬μ©
    - μ„λ²„ ν…ν”λ¦Ώμ€ λ¶λ³€ μΈν”„λΌλ΅ μ „ν™ν•λ” λ° μμ–΄ ν•µμ‹¬μ μΈ κµ¬μ„± μ”μ†
    - ν•λ² λ°°ν¬λ μ„λ²„λ” λ‹¤μ‹ λ³€κ²½λμ§€ μ•λ”λ‹¤. μƒ λ²„μ „μ μ½”λ“λ¥Ό λ°°ν¬ν•λ” κ²ƒκ³Ό κ°™μ΄ μ„λ²„λ¥Ό λ³€κ²½ν•΄μ•Ό ν•λ” κ²½μ° μƒ μ΄λ―Έμ§€λ¥Ό λ§λ“¤μ–΄ λ°°ν¬ν•΄μ•Ό ν•λ‹¤.
- μ¤μΌ€μ¤νΈλ μ΄μ… λ„κµ¬: μΏ λ²„λ„¤ν‹°μ¤, λ§λΌν†¤/λ©”μ†μ¤, Aws ECS, λ„μ»¤μ¤μ›, λ…Έλ§λ“
    - λ‹¤μ–‘ν• λ°°ν¬ μ „λµ μ§€μ›
    - VMκ³Ό μ»¨ν…μ΄λ„λ¥Ό ν•λ“μ›¨μ–΄ ν¨μ¨μ  λ°°ν¬
    - μƒνƒ λ¨λ‹ν„°λ§, μλ™ λ³µκµ¬
    - μ¤ν†  μ¤μΌ€μΌλ§
    - λ΅λ“ λ°Έλ°μ‹±
    - μ„λΉ„μ¤ λ””μ¤μ»¤λ²„λ¦¬
    - μ: k8s deployment.yml
    
    ```yaml
    apiVersion: apps/v1
    
    # Use a Deployment to deploy multiple replicas of your Docker
    # container(s) and to declaratively roll out updates to them
    kind: Deployment
    
    # Metadata about this Deployment, including its name
    metadata:
      name: example-app
    
    # The specification that configures this Deployment
    spec:
      # This tells the Deployment how to find your container(s)
      selector:
        matchLabels:
          app: example-app
    
      # This tells the Deployment to run three replicas of your
      # Docker container(s)
      replicas: 3
    
      # Specifies how to update the Deployment. Here, we
      # configure a rolling update.
      strategy:
        rollingUpdate:
          maxSurge: 3
          maxUnavailable: 0
        type: RollingUpdate
    
      # This is the template for what container(s) to deploy
      template:
    
        # The metadata for these container(s), including labels
        metadata:
          labels:
            app: example-app
    
        # The specification for your container(s)
        spec:
          containers:
    
            # Run Apache listening on port 80
            - name: example-app
              image: httpd:2.4.39
              ports:
                - containerPort: 80
    ```
    
- ν”„λ΅λΉ„μ €λ‹ λ„κµ¬: ν…λΌνΌ, ν΄λΌμ°λ“ν¬λ©”μ΄μ…, μ¤ν”μ¤νƒ ννΈ
    - κµ¬μ„±κ΄€λ¦¬, μ„λ²„ ν…ν”λ¦Ώ λ° μ¤μΌ€μ¤νΈλ μ΄μ… λ„κµ¬κ°€ κ° μ„λ²„μ—μ„ μ‹¤ν–‰λλ” μ½”λ“λ¥Ό μ •μν•λ‹¤λ©΄, ν”„λ΅λΉ„μ €λ‹ λ„κµ¬λ” μ„λ²„ μμ²΄ μƒμ„±ν•λ‹¤
    - λν• μΊμ‹, λ΅λ“λ°Έλ°μ„, λ¨λ‹ν„°λ§, ν, λ„¤νΈμ›ν¬ μ„¤μ •, λ³΄μ•, μΈμ¦μ„ λ“± μΈν”„λΌμ— κ΄€ν• κ±°μ λ¨λ“  λ¶€λ¶„μ„ ν”„λ΅λΉ„μ €λ‹ν•  μ μλ‹¤
    
    ```bash
    resource "aws_instance" "app" {
      instance_type     = "t2.micro"
      availability_zone = "us-east-2a"
      ami               = "ami-0fb653ca2d3203ac1"
    
      user_data = <<-EOF
                  #!/bin/bash
                  sudo service apache2 start
                  EOF
    }
    ```
    

### μ½”λ“ν• μΈν”„λΌμ μ΄μ 

- μ…€ν”„ μ„λΉ„μ¤
- μ†λ„μ™€ μ•μ •μ„±
    - μλ™ν™”λ ν”„λ΅μ„Έμ¤λ” μΌκ΄€λκ³  λ°λ³µ κ°€λ¥ν•λ©° μλ™λ³΄λ‹¤ μ¤λ¥κ°€ μ κ² λ°μƒν•λ‹¤
- λ¬Έμ„ν™”
- λ²„μ „ κ΄€λ¦¬
    - λ³€κ²½ λ‚΄μ—­μ΄ λ‚¨μ•„ μμΌλ―€λ΅ λ¬Έμ κ°€ λ°μƒν• μ§€μ μ„ μ°ΎκΈ° μμ›”ν•λ©° λ΅¤λ°±λ„ μ‰¬μ›€
- μ ν¨μ„± κ²€μ¦
    - μλ™ν™”λ ν…μ¤νΈλ¥Ό μ‹¤ν–‰ν•  μ μμ
- μ¬μ‚¬μ©μ„±
- μ§€λ£¨ν•κ³  λ°λ³µμ μΈ μ—…λ¬΄ μ κ±°

## ν…λΌνΌμ μ‘λ™ λ°©μ‹

ν…λΌνΌμ€ HashiCorpμ—μ„ λ§λ“  Go μ–Έμ–΄λ΅ μ‘μ„±λ μ¤ν”μ†μ¤ λ„κµ¬λ΅ `terraform` μ΄λΌλ” λ…λ Ήμ–΄λ΅ μ‹¤ν–‰ν•λ‹¤.

ν…λΌνΌ λ°”μ΄λ„λ¦¬λ” AWS, GCP λ“± ν΄λΌμ°λ“ κ³µκΈ‰μ APIλ¥Ό νΈμ¶ν•μ—¬ λ¦¬μ†μ¤λ¥Ό μƒμ„±ν•λ‹¤. 

```bash
resource "aws_instance" "example" {
  ami           = "ami-0fb653ca2d3203ac1"
  instance_type = "t2.micro"
}

resource "google_dns_record_set" "a" {
  name         = "demo.google-example.com"
  managed_zone = "example-zone"
  type         = "A"
  ttl          = 300
  rrdatas      = [aws_instance.example.public_ip]
}
```

μ„μ ν…λΌνΌ μ½”λ“λ” "t2.micro" νƒ€μ…μ aws μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•κ³  μƒμ„±ν• aws μΈμ¤ν„΄μ¤μ IPμ£Όμ†λ¥Ό κµ¬κΈ€ ν΄λΌμ°λ“μ DNS μ •λ³΄λ΅ μ§€μ •ν•λ‹¤.

ν…λΌνΌ κµ¬μ„± νμΌμ— μ„λ²„, DB, λ΅λ“λ°Έλ°μ„, λ„¤νΈμ›ν¬ν† ν΄λ΅μ§€ λ“± μ „μ²΄ μΈν”„λΌλ¥Ό μ •μν•κ³  λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•μ—¬ μΈν”„λΌλ¥Ό λ°°ν¬ν•  μ μλ‹¤. ν…λΌνΌ λ°”μ΄λ„λ¦¬λ” μ‚¬μ©μκ°€ κµ¬μ„±ν• μ½”λ“λ¥Ό νμ‹±ν•κ³  μ½”λ“μ— μ§€μ •λ ν΄λΌμ°λ“ κ³µκΈ‰μμ— λ€ν• μΌλ ¨μ API νΈμ¶λ΅ λ³€ν™ν•λ‹¤. 


> π’΅ ν΄λΌμ°λ“ κ³µκΈ‰μ κ°„ ν¬λ…ν• μ΄μ‹μ„±
> : ν…λΌνΌμ€ μ—¬λ¬ ν΄λΌμ°λ“ κ³µκΈ‰μλ¥Ό μ§€μ›ν•μ§€λ§ κ° ν΄λΌμ°λ“ κ³µκΈ‰μλ” λ™μΌν• μ ν•μ μΈν”„λΌλ¥Ό μ κ³µν•μ§€ μ•κΈ° λ•λ¬Έμ— μ •ν™•ν λ™μΌν• μΈν”„λΌλ¥Ό λ°°ν¬ν•  μ μ—†λ‹¤. ν• ν΄λΌμ°λ“ κ³µκΈ‰μμ κΈ°λ¥μ΄ λ‹¤λ¥Έ ν΄λΌμ°λ“μ—λ” μ΅΄μ¬ν•μ§€ μ•μ„ μ μλ‹¤.



## ν…λΌνΌκ³Ό λ‹¤λ¥Έ μ½”λ“ν• μΈν”„λΌ λΉ„κµ
λ§μ€ μ½”λ“ν• μΈν”„λΌ λ„κµ¬μ κΈ°λ¥μ€ μ„λ΅ κ²ΉμΉλ‹¤ μ–΄λ–¤ λ„κµ¬λ¥Ό μ„ νƒν•΄μ•Ό ν• κΉ?

### κµ¬μ„±κ΄€λ¦¬ vs ν”„λ΅λΉ„μ €λ‹
μ„λ²„ ν…ν”λ¦Ώ λ„κµ¬λ¥Ό μ‚¬μ©ν•λ” κ²½μ° λ€λ¶€λ¶„μ κµ¬μ„± κ΄€λ¦¬ μ”κµ¬ μ‚¬ν•­μ„ ν¬ν•¨ν•λ‹¤. 
λ°λ©΄ ν”„λ΅λΉ„μ €λ‹μ€ ν”„λ΅λΉ„μ €λ‹ λ„κµ¬κ°€ μµμ„ μ μ„ νƒμ΄λ‹¤.
μ„λ²„ ν…ν”λ¦Ώ λ„κµ¬λ¥Ό μ‚¬μ©ν•μ§€ μ•λ” κ²½μ° κµ¬μ„± κ΄€λ¦¬ λ° ν”„λ΅λΉ„μ €λ‹ λ„κµ¬λ¥Ό ν•¨κ» μ‚¬μ©ν•λ” κ²ƒμ΄ μΆ‹λ‹¤. μλ¥Ό λ“¤μ–΄ ν…λΌνΌκ³Ό μ…°ν”„λ¥Ό μ‹¤ν–‰ν•μ—¬ μ„λ²„λ¥Ό κµ¬μ„±ν•  μ μλ‹¤

### κ°€λ³€ μΈν”„λΌ vs λ¶λ³€ μΈν”„λΌ

#### κ°€λ³€ μΈν”„λΌ
κµ¬μ„± κ΄€λ¦¬ λ„κµ¬λ” μΌλ°μ μΌλ΅ κ°€λ³€ μΈν”„λΌ ν¨λ¬λ‹¤μ„μ„ μ‚¬μ©ν•λ‹¤. κ°€λ³€ μΈν”„λΌ ν¨λ¬λ‹¤μ„μ€ μ‹κ°„μ΄ μ§€λ‚λ©΄μ„ κµ¬μ„± λ“λ¦¬ν”„νΈκ°€ λ°μƒν•  μ μκ³  μ΄λ¬ν• λ²„κ·Έλ¥Ό νμ•…ν•κΈ° μ–΄λ µλ‹¤. 

#### λ¶λ³€ μΈν”„λΌ
ν”„λ΅λΉ„μ „ λ„κµ¬λ¥Ό μ‚¬μ©ν•μ—¬ μ„λ²„ ν…ν”λ¦Ώ λ„κµ¬λ΅ μƒμ„±ν• μ΄λ―Έμ§€λ¥Ό λ°°ν¬ν•λ” κ²½μ° λ³€κ²½μ€ μ™„μ „ν μƒλ΅μ΄ μ„λ²„λ¥Ό λ°°ν¬ν•λ” κ²ƒκ³Ό κ°™λ‹¤. μ‚¬μ†ν• λ³€κ²½μ—λ„ μƒλ΅μ΄ μ„λ²„μ΄λ―Έμ§€λ¥Ό μ¬λ°°ν¬ν•΄μ•Ό ν•λ―€λ΅ μ‹κ°„μ΄ μ¤λ κ±Έλ¦Ό

### μ μ°¨μ  μ–Έμ–΄ vs μ„ μ–Έμ  μ–Έμ–΄
μ•¤μ„λΈ” λ“± κµ¬μ„± κ΄€λ¦¬ λ„κµ¬λ” μµμΆ… μƒνƒμ— λ‹¬μ„±ν•λ” λ°©λ²•μ„ λ‹¨κ³„λ³„λ΅ μ§€μ •ν•λ” μ μ°¨μ  μ¤νƒ€μΌμ μ½”λ“λ¥Ό κ¶μ¥ν•λ‹¤.

ν…λΌνΌ λ“± ν”„λ΅λΉ„μ €λ‹ λ„κµ¬λ” μµμΆ… μƒνƒλ¥Ό μ§€μ •ν•λ” μ„ μ–Έμ  λ°©μ‹μ μ½”λ“λ¥Ό κ¶μ¥ν•λ‹¤.
 μλ¥Ό λ“¤μ–΄ μ΄λ―Έ 10λ€μ μ„λ²„κ°€ λ°°ν¬λμ–΄ μκ³  15λ€λ΅ μ¤μΌ€μΌ μ•„μ›ƒμ„ μν–‰ν•κΈ° μ„ν• μ•¤μ„λΈ”(μ μ°¨)κ³Ό ν…λΌνΌ(μ„ μ–Έ)μ μ ‘κ·Ό λ°©μ‹μ—λ” μ°¨μ΄κ°€ μλ‹¤.

> ν…λΌνΌ κµ¬μ„± νμΌ
> 
> 
> ```bash
> resource "aws_instance" "example" {
>   count         = 15
>   ami           = "ami-0fb653ca2d3203ac1"
>   instance_type = "t2.micro"
> }
> ```
> 

> μ•¤μ„λΈ” κµ¬μ„± νμΌ
> 
> 
> ```yaml
> - ec2:
>     count: 5
>     image: ami-0fb653ca2d3203ac1
>     instance_type: t2.micro
> ```
> 

ν…λΌνΌμ€ κµ¬μ„±νμΌμ— μµμΆ… μƒνƒλ¥Ό λ…μ‹ν•λ―€λ΅ count λ¥Ό 15λ΅ μ§€μ •ν•λ©΄ μ΄μ „ λ°°ν¬ κΈ°λ΅μ„ κ°–κ³  μμ–΄ 5κ°μ μ¶”κ°€ μ„λ²„λ¥Ό μƒμ„±ν•λ” λ°λ©΄ μ•¤μ„λΈ”μ€ μ μ°¨μ§€ν–¥μ΄λ―€λ΅ 10κ° μ΄ν›„ μ¶”κ°€ 5κ°μ μ„λ²„λ¥Ό μƒμ„±ν•λ„λ΅ λ…λ Ήν•΄μ•Ό ν•λ‹¤ λ”°λΌμ„ count λ¥Ό 5λ΅ ν•μ—¬ λ°°ν¬ν•λ‹¤.

λ¬Όλ΅  μ•¤μ„λΈ”μ—μ„λ„ μƒ μΈμ¤ν„΄μ¤λ¥Ό λ°°ν¬ν•κΈ° μ „ νƒκ·Έλ¥Ό μ‚¬μ©ν•μ—¬ ec2 μΈμ¤ν„΄μ¤λ¥Ό κ²€μƒ‰ν•κ³  μµμΆ… μƒνƒ μ 15μ™€ λΉ„κµν•μ—¬ μΈμ¤ν„΄μ¤λ¥Ό μ¦κ°ν•  μ μμ§€λ§ μ΄λ¬ν• μΆ…λ¥μ λ΅μ§μ„ μλ™μΌλ΅ νμ•…ν•μ—¬ μ§€μ •ν•΄μ•Ό ν•λ‹¤. 

μ¦‰ μ„μ μλ” μ•„λμ μ£Όμ”ν• λ¬Έμ λ¥Ό ν•¨μν•λ‹¤

- μ μ°¨μ  μ½”λ“λ” μΈν”„λΌμ λ§μ§€λ§‰ μƒνƒ μ •λ³΄λ¥Ό κΈ°λ΅ν•μ§€ μ•λ”λ‹¤
- μ μ°¨μ  μ½”λ“λ” μ¬μ‚¬μ© κ°€λ¥μ„±μ„ μ ν•ν•λ‹¤

## λ§μ¤ν„° μ„λ²„ μ λ¬΄

μ…°ν”„, νΌν•, μ†”νΈ μ¤νƒμ€ μΈν”„λΌ μƒνƒλ¥Ό μ €μ¥ν•κ³  μ—…λ°μ΄νΈλ¥Ό λ°°ν¬ν•κΈ° μ„ν•΄ λ§μ¤ν„° μ„λ²„λ¥Ό μ‹¤ν–‰ν•λ‹¤. 

**λ§μ¤ν„° μ„λ²„μ μ¥μ **

- μΈν”„λΌμ κµ¬μ„± μ§„ν–‰ μƒνƒλ¥Ό μ¤‘μ•™μ—μ„ μ‰½κ² ν™•μΈ κ°€λ¥
- λ°±κ·ΈλΌμ΄λ“μ—μ„ κµ¬μ„±μ„ μ§€μ†μ μΌλ΅ μ μ© κ°€λ¥. μλ™μΌλ΅ μ„λ²„λ¥Ό λ³€κ²½ν•΄λ„ λ§μ¤ν„°κ°€ ν•΄λ‹Ή λ³€κ²½ μ‚¬ν•­μ„ λλλ ¤ κµ¬μ„± λ“λ¦¬ν”„νΈ λ°©μ§€

**λ§μ¤ν„° μ„λ²„μ λ‹¨μ **

- λ§μ¤ν„°λ¥Ό μ‹¤ν–‰ν•κΈ° μ„ν• μ¶”κ°€ μΈν”„λΌ ν•„μ”
- λ§μ¤ν„° μ„λ²„λ¥Ό μ μ§€ κ΄€λ¦¬ ν•΄μ•Ό ν•¨
- ν΄λΌμ΄μ–ΈνΈκ°€ λ§μ¤ν„°μ™€ ν†µμ‹ ν•λ” λ°©λ²•, λ§μ¤ν„°κ°€ λ‹¤λ¥Έ μ„λ²„μ™€ ν†µμ‹ ν•  λ°©λ²•μ„ μ κ³µν•μ•Ό ν•λ©° μ΄λ” μ¶”κ°€ ν¬νΈλ¥Ό μ—΄κ³  μ¶”κ°€ μΈμ¦ μ‹μ¤ν…μ„ κµ¬μ„±ν•λ” κ²ƒμ„ μλ―Έν•λ―€λ΅ λ³΄μ•μ— μ·¨μ•½ν•  μ μμ

### μ—μ΄μ „νΈ μ λ¬΄

μ…°ν”„, νΌν•μ€ κµ¬μ„±ν•λ ¨λ μ„λ²„μ— μ—μ΄μ „νΈλ¥Ό μ„¤μΉν•λ„λ΅ μ”κµ¬ν•λ‹¤. 

**λ‹¨μ **

- λ¶€νΈμ¤νΈλν•‘: μ—μ΄μ „νΈλ¥Ό μ„¤μΉν•κΈ° μ„ν•΄ μ™Έλ¶€ ν”„λ΅μ„Έμ¤μ— μμ΅΄ν•λ‹¤. μλ¥Ό λ“¤μ–΄ μ—μ΄μ „νΈκ°€ μ΄λ―Έ μ„¤μΉλ μ„λ²„ μ΄λ―Έμ§€λ¥Ό λ°°ν¬ν•΄μ•Ό ν•¨
- μ μ§€: μ£ΌκΈ°μ μΌλ΅ μ—μ΄μ „νΈλ¥Ό μ—…λ°μ΄νΈ ν•΄μ•Ό ν•κ³  λ§μ¤ν„°κ°€ μλ” κ²½μ° λ§μ¤ν„°μ™€ λ™κΈ°ν™”λ¥Ό μ μ§€ν•λ„λ΅ μ£Όμν•΄μ•Ό ν•¨
- λ³΄μ•: λ§μ¤ν„°λ΅ λ¶€ν„° κµ¬μ„±μ„ ν’€λ‹¤μ΄/ν‘Έμ‹ν•κΈ° μ„ν•΄ μ•„μ›ƒλ°”μ΄λ“/μΈλ°”μ΄λ“ ν¬νΈλ¥Ό μ—΄μ–΄μ•Ό ν•¨. μ¤‘μ•™μ„λ²„μ— λ€ν•΄ μ—μ΄μ „νΈλ¥Ό μΈμ¦ν•λ” λ°©λ²•μ„ νμ•…ν•΄μ•Ό ν•¨

### μ»¤λ®¤λ‹ν‹° κ·λ¨
μ•¤μ„λΈ”κ³Ό ν…λΌνΌμ€ ν­λ°μ μΌλ΅ μ„±μ¥ν•κ³  μμΌλ©° λ‘ λ„κµ¬ λ¨λ‘ μ•μΌλ΅ λ” μ»¤μ§ κ°€λ¥μ„±μ΄ λ†’λ‹¤.

### μ—¬λ¬ λ„κµ¬λ¥Ό ν•¨κ» μ‚¬μ©

- ν”„λ΅λΉ„μ €λ‹κ³Ό κµ¬μ„± κ΄€λ¦¬
    - ν…λΌνΌκ³Ό μ•¤μ„λΈ”
    -  ![terraform with ansible](terraform_1_3.png)
    - μ‹μ‘ν•κΈ° μ‰¬μ΄ μ ‘κ·Ό λ°©μ‹μ΄λ‚ μ•¤μ„λΈ”μ„ μ‚¬μ©ν•λ©΄ κ°€λ³€μ  μ„λ²„λ¥Ό μ‚¬μ©ν•λ―€λ΅ κ·λ¨κ°€ μ»¤μ§ μλ΅ μ μ§€κ΄€λ¦¬κ°€ μ–΄λ ¤μ›μ§ μ μμ
- ν”„λ΅λΉ„μ €λ‹κ³Ό μ„λ²„ ν…ν”λ¦Ώ
    - ν…λΌνΌκ³Ό ν¨μ»¤
    - μ•±μ„ VM μ΄λ―Έμ§€λ΅ ν¨ν‚Ήν•κ³  μΈν”„λΌ κµ¬μ„±μ„ ν…λΌνΌμΌλ΅ ν”„λ΅λΉ„μ €λ‹
    - ![terraform with packer](terraform_1_4.png)
    - λ¶λ³€μ  μ„λ²„λ΅ μ μ§€ κ΄€λ¦¬κ°€ μ‰½λ‹¤.
    - λ‹¤λ§ VMμ„ κµ¬μ¶•ν•κ³  λ°°ν¬ν•λ”λ° μ‹κ°„μ΄ μ¤λ κ±Έλ¦Ό. λ°°ν¬ μ „λµ(λΈ”λ£¨-κ·Έλ¦° λ¶κ°€)μ΄ μ ν•λμ–΄ μμ
- ν”„λ΅λΉ„μ €λ‹ + μ„λ²„ ν…ν”λ¦Ώ + μ¤μΌ€μ¤νΈλ μ΄μ…
    - ν…λΌνΌ, ν¨μ»¤, μΏ λ²„λ„¤ν‹°μ¤
    - ν¨μ»¤λ¥Ό μ‚¬μ©ν•μ—¬ k8s μ—μ΄μ „νΈκ°€ μ„¤μΉλ VM μ΄λ―Έμ§€λ¥Ό λ§λ“¤κ³  ν…λΌνΌμ„ μ‚¬μ©ν•μ—¬ μΈν”„λΌ κµ¬μ„±μ„ ν”„λ΅λΉ„μ €λ‹
    - ![terraform with packer, k8s](terraform_1_5.png)
    - λ°°ν¬μ „λµ, μλ™ λ³µκµ¬, ν™•μ¥ λ“± λ‹¤μ–‘ν• k8s λ‚΄μ¥κΈ°λ¥μ„ μ‚¬μ©κ°€λ¥
    - λ‹¨ k8s κ³„μΈµμ΄ μ¶”κ°€λ¨μΌλ΅μ¨ λ³µμ΅μ„± μ¦λ€

### κ²°λ΅ 
μ½”λ“ν• μΈν”„λΌ λ„κµ¬λ” λ‹¤λ¥Έ κµ¬μ„±μ— μ‚¬μ©ν•  μ μμ„ λ§νΌ μ μ—°ν•λ‹¤. λ”°λΌμ„ μ‚¬μ©μμ μ”κµ¬μ‚¬ν•­κ³Ό κΈ°μ¤€μ— λ§μ¶° μ½”λ“ν• μΈν”„λΌ λ„κµ¬λ¥Ό μ„ νƒν•  μ μλ‹¤.

μ €μλ” λ¶λ³€ μΈν”„λΌμ™€ μ„ μ–Έμ  μ–Έμ–΄, λ§μ¤ν„°μ™€ μ—μ΄μ „νΈκ°€ μ—†κ³  λ€κµλ¨ μ»¤λ®¤λ‹ν‹°μ™€ μ„±μ™ν• μ½”λ“λ² μ΄μ¤λ¥Ό κ°–μ¶”μ—μΌλ©° ν΄λΌμ°λ“μ— μΆ…μ†λμ§€ μ•λ” μ¤ν” μ†μ¤ ν”„λ΅λΉ„μ €λ‹ λ„κµ¬λ¥Ό μ›ν–κΈ° λ•λ¬Έμ— ν…λΌνΌμ„ μ„ νƒν•¨